<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Admin - Seelenzauber Alpaka</title>
    <link rel="stylesheet" href="css/admin.css?v=20251119-1530">
</head>
</head>
<body>
        <script>
            // Auth-Check: nicht eingeloggt? -> Login
            (function(){
                const ADMIN_BASE = `${location.origin}/Backend`;
                fetch(`${ADMIN_BASE}/me.php`, { credentials: 'include' })
                    .then(r=>r.json()).then(d=>{ if (!d.authenticated) location.replace('/admin/login.html'); })
                    .catch(()=>{});
            })();
        </script>
    <div class="admin-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="logo">ü¶ô Admin Panel</div>
            <nav class="admin-nav">
                <a href="#dashboard" class="nav-item" data-view="dashboard">
                    üìä Dashboard
                </a>
                <a href="#einstellungen" class="nav-item" data-view="einstellungen">
                    ‚öôÔ∏è Einstellungen
                </a>
                <a href="#alpakas" class="nav-item" data-view="alpakas">
                    ü¶ô Alpakas
                </a>
                <a href="#termine" class="nav-item" data-view="termine">
                    üìÖ Termine
                </a>
                <a href="#buchungen" class="nav-item" data-view="buchungen">
                    üìù Buchungen
                </a>
                <a href="#kontakt" class="nav-item" data-view="kontakt">
                    ‚úâÔ∏è Kontaktanfragen
                </a>
                <a href="#galerie" class="nav-item" data-view="galerie">
                    üñºÔ∏è Galerie
                </a>
                <a href="#benutzer" class="nav-item" data-view="benutzer">
                    üßë Benutzer
                </a>
            </nav>
            <div class="sidebar-footer">
                <a href="/" class="btn-logout">‚Üê Zur Website</a>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="admin-header">
                <h1 id="page-title">Dashboard</h1>
                <div class="user-info">
                    <span>Admin</span>
                    <a href="#" onclick="logout(); return false;" class="btn btn-secondary" style="margin-left:12px;">Abmelden</a>
                </div>
            </header>

            <div class="content-area">
                <!-- Dashboard View -->
                <div id="view-dashboard" class="view active">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number" id="stat-alpakas">0</div>
                            <div class="stat-label">Alpakas</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="stat-termine">0</div>
                            <div class="stat-label">Aktive Termine</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="stat-buchungen">0</div>
                            <div class="stat-label">Buchungen</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="stat-kontakt">0</div>
                            <div class="stat-label">Neue Anfragen</div>
                        </div>
                    </div>

                    <div class="recent-section">
                        <h2>Neueste Buchungen</h2>
                        <div id="recent-buchungen" class="data-table"></div>
                    </div>
                </div>

                <!-- Alpakas View -->
                <div id="view-alpakas" class="view">
                    <button class="btn btn-primary" onclick="showAddAlpakaForm()">+ Neues Alpaka</button>
                    <div id="alpakas-list" class="data-table"></div>
                </div>

                <!-- Termine View -->
                <div id="view-termine" class="view">
                    <button class="btn btn-primary" onclick="showAddTerminForm()">+ Neuer Termin</button>
                    <div id="termine-list" class="data-table"></div>
                </div>

                <!-- Termin-Modal -->
                <div id="termin-modal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2>Neuen Termin anlegen</h2>
                            <button class="modal-close" onclick="closeTerminModal()">&times;</button>
                        </div>
                        <form id="termin-form" class="modal-body">
                            <div class="form-group">
                                <label>Titel</label>
                                <input type="text" id="termin-titel" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label>Datum</label>
                                <input type="date" id="termin-datum" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label>Uhrzeit von</label>
                                <input type="time" id="termin-uhrzeit-von" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label>Uhrzeit bis</label>
                                <input type="time" id="termin-uhrzeit-bis" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label>Max. Teilnehmer</label>
                                <input type="number" id="termin-max-teilnehmer" class="form-control" min="1" required>
                            </div>
                            <div class="form-group">
                                <label>Preis (‚Ç¨)</label>
                                <input type="number" id="termin-preis" class="form-control" min="0" step="0.01" required>
                            </div>
                            <div class="modal-actions">
                                <button type="submit" class="btn btn-primary">üíæ Termin speichern</button>
                                <button type="button" class="btn btn-secondary" onclick="closeTerminModal()">Abbrechen</button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Buchungen View -->
                <div id="view-buchungen" class="view">
                    <div id="buchungen-list" class="data-table"></div>
                </div>

                <!-- Kontakt View -->
                <div id="view-kontakt" class="view">
                    <div id="kontakt-list" class="data-table"></div>
                </div>

                <!-- Galerie View -->
                <div id="view-galerie" class="view">
                    <button class="btn btn-primary" onclick="showAddImageForm()">+ Bild hochladen</button>
                    <div id="galerie-list" class="gallery-grid"></div>
                </div>

                <!-- Benutzer View -->
                <div id="view-benutzer" class="view">
                    <button class="btn btn-primary" onclick="showAddBenutzerForm()">+ Neuer Benutzer</button>
                    <div id="benutzer-list" class="data-table"></div>
                </div>

                <!-- Einstellungen View -->
                <div id="view-einstellungen" class="view">
                    <div class="settings-container">
                        <h2>Website-Einstellungen</h2>
                        <form id="settings-form" class="settings-form">
                            <div class="form-group">
                                <label>Website-Name</label>
                                <input type="text" id="site-name" class="form-control" placeholder="Seelenzauber Alpaka">
                            </div>
                            <div class="form-group">
                                <label>Website-Beschreibung (SEO)</label>
                                <textarea id="site-description" class="form-control" rows="3" placeholder="Alpaka-Wanderungen und -Erlebnisse..."></textarea>
                            </div>
                            <div class="form-group">
                                <label>Keywords (Google, kommagetrennt)</label>
                                <input type="text" id="site-keywords" class="form-control" placeholder="Alpaka, Wanderung, Tirol">
                            </div>
                            <div class="form-group">
                                <label>Favicon URL</label>
                                <input type="text" id="site-favicon" class="form-control" placeholder="/images/favicon.ico">
                            </div>
                            <div class="form-group">
                                <label>Open Graph Bild (Facebook/Social)</label>
                                <input type="text" id="site-og-image" class="form-control" placeholder="/images/og-image.jpg">
                            </div>
                            <div class="form-group">
                                <label>Google Analytics ID</label>
                                <input type="text" id="site-ga-id" class="form-control" placeholder="G-XXXXXXXXXX">
                            </div>
                            <div class="form-group">
                                <label>Microsoft Clarity ID</label>
                                <input type="text" id="site-clarity-id" class="form-control" placeholder="XXXXXXXXXX">
                            </div>
                            <button type="submit" class="btn btn-primary">Einstellungen speichern</button>
                        </form>
                    </div>
                </div>
            </div>
        </main>
    </div>

                <!-- Benutzer-Modal -->
                <div id="benutzer-modal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2>Neuen Benutzer anlegen</h2>
                            <button class="modal-close" onclick="closeBenutzerModal()">&times;</button>
                        </div>
                        <form id="benutzer-form" class="modal-body">
                            <div class="form-group">
                                <label>Name</label>
                                <input type="text" id="benutzer-name" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label>E-Mail</label>
                                <input type="email" id="benutzer-email" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label>Rolle</label>
                                <select id="benutzer-rolle" class="form-control" required>
                                    <option value="admin">Admin</option>
                                    <option value="editor" selected>Editor</option>
                                    <option value="viewer">Viewer</option>
                                </select>
                            </div>
                            <div class="modal-actions">
                                <button type="submit" class="btn btn-primary">üíæ Benutzer anlegen</button>
                                <button type="button" class="btn btn-secondary" onclick="closeBenutzerModal()">Abbrechen</button>
                            </div>
                            <p style="margin-top: 16px; color: #666; font-size: 0.875rem;">
                                ‚ÑπÔ∏è Der Benutzer erh√§lt eine E-Mail mit einem Link zum Festlegen des Passworts.
                            </p>
                        </form>
                    </div>
                </div>

    <!-- Bild-Detail Modal -->
    <div id="image-modal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>Bild-Details</h2>
                <button class="modal-close" onclick="closeImageModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="image-detail-container">
                    <div class="image-detail-preview">
                        <img id="detail-image" src="" alt="">
                    </div>
                    <div class="image-detail-info">
                        <div class="form-group">
                            <label>Dateiname</label>
                            <input type="text" id="detail-filename" class="form-control" readonly>
                        </div>
                        <div class="form-group">
                            <label>Typ</label>
                            <input type="text" id="detail-typ" class="form-control" readonly>
                        </div>
                        <div class="form-group">
                            <label>Beschreibung</label>
                            <textarea id="detail-beschreibung" class="form-control" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Bildgr√∂√üe</label>
                            <input type="text" id="detail-size" class="form-control" readonly>
                        </div>
                        <div class="form-group">
                            <label>Hochgeladen am</label>
                            <input type="text" id="detail-date" class="form-control" readonly>
                        </div>
                        <div class="form-group">
                            <label>URL</label>
                            <div class="url-copy-group">
                                <input type="text" id="detail-url" class="form-control" readonly>
                                <button type="button" class="btn btn-secondary" onclick="copyImageUrl()">üìã Kopieren</button>
                            </div>
                        </div>
                        <div class="modal-actions">
                            <button type="button" class="btn btn-danger" onclick="deleteImage()">üóëÔ∏è Bild l√∂schen</button>
                            <button type="button" class="btn btn-primary" onclick="saveImageDetails()">üíæ Speichern</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/admin.js?v=20251119-1530"></script>
</body>
</html>
